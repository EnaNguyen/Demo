<div class="detail-wrapper" *ngIf="product">
  <div class="breadcrumb">
    <a routerLink="/">Trang chủ</a>
    <span>/</span>
    <span>{{ product.label }}</span>
  </div>

  <div class="detail-container">
    <div class="product-gallery">
      <div class="main-image">
        <img [src]="selectedImage" [alt]="product.label" />
      </div>
    </div>
    <div class="product-info">
      <h1 class="product-title">{{ product.label }}</h1>
      
      <div class="product-brand">
        <span class="brand-label">Thương hiệu:</span>
        <span class="brand-name">{{ getPropertyValue(product, 'brand') }}</span>
      </div>

      <div class="product-price">
        <span class="price">{{ formatPrice(getPropertyValue(product, 'price')) }}</span>
      </div>

      <div class="product-stock">
        <span [class.in-stock]="getPropertyValue(product, 'quantity') > 0"
              [class.out-of-stock]="getPropertyValue(product, 'quantity') <= 0">
          {{ getPropertyValue(product, 'quantity') > 0 ? 'Còn hàng' : 'Hết hàng' }}
        </span>
        <p>Số lượng tối đa có thể thêm vào giỏ hàng: {{ getMaxQuantity() }}</p>
        <span class="stock-quantity">
          ({{ getPropertyValue(product, 'quantity') }} sản phẩm có sẵn)
        </span>
      </div>

      <div class="quantity-section" *ngIf="getPropertyValue(product, 'quantity') > 0">
        <label>Số lượng:</label>
        <div class="quantity-control">
          <button class="qty-btn" (click)="decreaseQuantity()" [disabled]="quantity <= 1">
            −
          </button>
          <input type="number" [(ngModel)]="quantity" [max]="getPropertyValue(product, 'quantity')" min="1" readonly />
          <button class="qty-btn" (click)="increaseQuantity()" 
                  [disabled]="quantity >= getPropertyValue(product, 'quantity')">
            +
          </button>
        </div>
      </div>
      <div class="action-buttons">
        <button class="btn-add-cart" 
                (click)="addToCart()"
                [disabled]="getPropertyValue(product, 'quantity') <= 0">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="9" cy="21" r="1"></circle>
            <circle cx="20" cy="21" r="1"></circle>
            <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
          </svg>
          Thêm vào giỏ hàng
        </button>
        
      </div>
      <div class="product-details">
        <h3>Thông tin chi tiết</h3>
        <div class="detail-row">
          <span class="detail-label">Ngày phát hành:</span>
          <span class="detail-value">{{ formatDate(getPropertyValue(product, 'releaseDate')) }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Mã sản phẩm:</span>
          <span class="detail-value">{{ product.key }}</span>
        </div>
      </div>
    </div>
  </div>
  <div class="description-section">
    <h2>Mô tả sản phẩm</h2>
    <div class="description-content">
      {{ getPropertyValue(product, 'description') || 'Chưa có mô tả cho sản phẩm này.' }}
    </div>
  </div>
</div>

<div class="not-found" *ngIf="!product">
  <div class="not-found-content">
    <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <circle cx="12" cy="12" r="10"></circle>
      <line x1="12" y1="8" x2="12" y2="12"></line>
      <line x1="12" y1="16" x2="12.01" y2="16"></line>
    </svg>
    <h2>Sản phẩm không tồn tại</h2>
    <p>Rất tiếc, chúng tôi không tìm thấy sản phẩm bạn đang tìm kiếm.</p>
    <a routerLink="/" class="btn-back-home">Quay lại trang chủ</a>
  </div>
</div>